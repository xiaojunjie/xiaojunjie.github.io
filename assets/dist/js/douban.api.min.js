function DoubanApi(){this.defaults={place:"douban",user:"88007311",api:"0e030d6a0799d83d2a09283e16cd88b7",book:[{status:"reading",maxnum:20},{status:"read",maxnum:100},{status:"wish",maxnum:100}],bookreadingtitle:"在读 · · ·",bookreadtitle:"读过 · · ·",bookwishtitle:"想读 · · ·"}}DoubanApi.prototype.make_api_url=function(t,a,e,i,n,s){var u="http://api.douban.com/people/"+a+"/collection?cat="+t+"&start-index="+n+"&max-results="+s+"&status="+i+"&alt=xd&callback=dbapi."+t+i+"_show";return e.lenght>0&&(u+="&apikey="+e),u},DoubanApi.prototype.make_list_item=function(t){var a="";return $.each(t,function(t,e){a+='<li><a href="'+e.link+'" target="_blank"><img src="'+e.src+'" alt="'+e.title+'" title="'+e.title+'" /></a></li>'}),a},DoubanApi.prototype.parse_json=function(t){var a=[];return $.each(t.entry,function(t,e){var i={};i.title=e["db:subject"].title.$t,i.link=e["db:subject"].link[1]["@href"],i.src=e["db:subject"].link[2]["@href"],a.push(i)}),a},DoubanApi.prototype.fix_num=function(t){var a=1,e=[];if(50>t&&t>0)e.push({begin:a,end:t});else for(;t>0;)e.push({begin:a,end:a+49}),t-=50,a+=50;return e},DoubanApi.prototype.show=function(){var t=[],a=this;$.each(this.defaults.book,function(e,i){var n=a.fix_num(i.maxnum);t.push({status:i.status,indexs:n})}),$.each(t,function(t,e){$.each(e.indexs,function(t,i){a.appendScript(a.all_url("book",e.status,i.begin,i.end))})})},DoubanApi.prototype.appendScript=function(t){t&&t.length>0&&$("<script/>").attr("src",t).attr("charset","utf-8").appendTo($("head")[0])},DoubanApi.prototype.all_url=function(t,a,e,i){if(0!==i)return this[t+a+"_show"]||(this[t+a+"_show"]=function(e){var i=$("#"+this.defaults.place);if(0===i.length&&(i=$('<div id="'+this.defaults.place+'"></div>').prependTo($("body"))),0===$("#"+t+a).length){var n=this.defaults[t+a+"title"];$('<h2 class="douban-title">'+n+"</h2>").appendTo(i),$('<div id="'+t+a+'" class="douban-list clearfix"><ul></ul></div>').appendTo(i)}$("#"+t+a+" > ul").append(this.make_list_item(this.parse_json(e)))}),this.make_api_url(t,this.defaults.user,this.defaults.api,a,e,i)};